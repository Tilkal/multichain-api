language: node_js

env:
  global:
    - CC_TEST_REPORTER_ID=374504f501623c1874574ef45305517e46ff285d254255c32e792141cffb5028
    - GIT_COMMITTED_AT=$(if [ "$TRAVIS_PULL_REQUEST" == "false" ]; then git log -1 --pretty=format:%ct; else git log -1 --skip 1 --pretty=format:%ct; fi)

node_js:
  - '8'
  - '7'
  - '6'

before_script:
  - if [ "$TRAVIS_PULL_REQUEST" == "false" ]; then
      curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter;
      chmod +x ./cc-test-reporter;
      ./cc-test-reporter before-build;
    fi

script:
  - npm run ci:build
  - npm run ci:lint
  - npm run ci:test

after_script:
  - if [ "$TRAVIS_PULL_REQUEST" == "false" ]; then ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT; fi

notifications:
  email: false
  slack:
    secure: N18EJUyjMZA6PykhatqGnC+3BUaz5r7HxqPUcn13UkGpDHcpPyUeBIeAa5QkG4t2tD8EIJ+Ux2qXPJKpxvwvAMdh6i+Et8zvWdzjXs8VbQYcFjIjP8dOrwaCfOia34he7IKXXdzNsN9UZvcWYpJLyB11ELE9voio8o9DE1sbmEdYYEwoVB86OpX28w/gawSNkJExtZzZPN8kDKpAtKvs10ofXzTlTofKBiVuocn6ixW9akyT7PIIfhuQl9iQscf6LlyP0z4LBUnKB04tHA6e+GFBA06SPreIL2jvaAXTNThRk8h9m43QpEKfD7qc+arg7MAnZpxGkAufepS4GlWHQN3g2Akas1IvZQD8+RIaXnxS+KSaRIZh4JdjWd6oWGs3vS96U5GJU6whmIsbnJGurIGpaiVPRJ5Vkndc0XUVO/sSsmP5vyR/4ScEza2oIoBIo0AQnaPiZX5aHCk82Nq2nJM1zpN09f1LWpZRvnZojLZyiU0eMy2srSc/emM7l8u/vguKxPscb9lOqgidF+A/fiVtxj/CEL5/5SJldulCsVX4gG4q1VV5EfTxxkKAw0VuPD8bDkX12+SXrRrFi7YULA/ousVOHKA0i0ugVlecKrX5LCkTiCQk9Qmky4+p2U2AyZu9ke2apzxrH3g7ex6vuxWYv2t9oK8TS2SfE06GwcI=
